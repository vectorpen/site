(function(A){A.fn.tinyLightbox=function(T){var e={slideShow:5000,sound:null,soundAttr:"rel",pathAttr:"href",descrAttr:"title",resizeSpeed:300,fadeInSpeed:300,fadeOutSpeed:300,slideSpeed:300,border:10,top:20,prevLabelText:"&laquo; Previos",nextLabelText:"Next &raquo;",statLabelImage:"Image",statLabelFrom:"from"};A.extend(e,T);var P=[],Y=[],R=[],S,O,f,I,F,L,U,H,Z,E,W=this;A(W).click(function(){var d=A(this).attr(e.pathAttr);if(d){S=A.inArray(d,P);D(d,function(g){K(g,function(){C(g)})});Q();M();if(e.sound&&e.sound.autostart){sound("play")}this.onclick=function(){return false};return false}}).each(function(d,g){P[d]=A(g).attr(e.pathAttr);Y[d]=A(g).attr(e.descrAttr)||"";R[d]=A(g).attr(e.soundAttr)||null});function Q(){F=A(document).scrollTop();L=A(document).height()+F;U=A(document).width();A("body").append(A("<div>").attr("id","tinyLightboxOverlay").click(function(){J()}),A("<div>").attr({id:"tinyLightboxContainer",className:"loading"}).css({top:F+e.top,left:U/2-100,display:"block"}));V()}function K(d,g){O=d.width+e.border*2;f=d.height+e.border*2;I=U/2-O/2;A("#tinyLightboxContainer").animate({width:O,left:I},e.resizeSpeed,function(){A(this).animate({height:f-e.border},e.resizeSpeed,function(){A(g);c()})})}function c(){P[S+1]?d():i();P[S-1]?g():h();function g(){h();A('<a id="tinyLightboxLeftHandle" class="tinyLightboxHandle"/>').css("width",O/2).appendTo("#tinyLightboxContainer").click(function(){a(-1)}).mouseover(function(){A("#tinyLightboxLeftLabel").show(e.slideSpeed)}).mouseout(function(){A("#tinyLightboxLeftLabel, ").hide(e.slideSpeed)});A('<a id="tinyLightboxLeftLabel" class="tinyLightboxLabel"/>').appendTo("#tinyLightboxContainer").html(e.prevLabelText)}function h(){A("#tinyLightboxLeftHandle, #tinyLightboxLeftLabel").remove()}function d(){i();A('<a id="tinyLightboxRightHandle" class="tinyLightboxHandle"/>').css("width",O/2).appendTo("#tinyLightboxContainer").click(function(){a(1)}).mouseover(function(){A("#tinyLightboxRightLabel").show(e.fadeInSpeed)}).mouseout(function(){A("#tinyLightboxRightLabel, ").hide(e.fadeOutSpeed)});A('<a id="tinyLightboxRightLabel" class="tinyLightboxLabel"/>').appendTo("#tinyLightboxContainer").html(e.nextLabelText)}function i(){A("#tinyLightboxRightHandle, #tinyLightboxRightLabel").remove()}}function C(d){A("<img/>").attr({id:"tinyLightboxImage",src:d.src}).appendTo("#tinyLightboxContainer").fadeIn(e.fadeInSpeed*2/3,function(){G()})}function X(d){A("#tinyLightboxLeftLabel, #tinyLightboxRightLabel").hide(e.slideSpeed);A("#tinyLightboxImage").fadeOut(e.fadeOutSpeed*2/3,function(){A(this).remove();A(d)})}function G(){A("#tinyLightboxContainer").append(A('<div id="tinyLightboxBar">').append(A('<div id="tinyLightboxBarText">').append("<p>"+Y[S]+"</p>"+B(),W.slideShow("getBtn")),A('<div id="tinyLightboxCloseLabel"/>').click(function(){J()})).css({padding:e.border,width:O-e.border*2}));A("#tinyLightboxBar").slideDown(e.slideSpeed,function(){V()})}function b(d){A("#tinyLightboxBar").slideUp(e.slideSpeed,function(){A(this).remove();A(d)})}function N(g,d,h){var i=parseInt(g.css("left").split("px")[0]);g.animate({left:i+d},h,function(){g.animate({left:i-2*d},h,function(){g.animate({left:i+2*d},h,function(){g.animate({left:i},h)})})})}function J(){A("#tinyLightboxContainer").fadeOut(e.fadeOutSpeed/2,function(){A("#tinyLightboxOverlay").fadeOut(e.fadeOutSpeed/2,function(){A("#tinyLightboxOverlay, #tinyLightboxContainer").remove();A(document).unbind("keydown");H=false})})}function a(d){if(!H){if(P[S+d]){S=S+d;H=true;b(function(){X(function(){D(P[S],function(g){K(g,function(){C(g);H=false})})})})}else{return true}}}function V(){A("#tinyLightboxOverlay").css({height:L+e.top,width:U})}function D(d,g){A("#tinyLightboxContainer").addClass("loading");W.pause(100,function(){var h=new Image();h.onload=function(){A("#tinyLightboxContainer").removeClass("loading");A(g(h))};h.src=d})}function B(){return"<span>"+e.statLabelImage+" "+(S+1)+" "+e.statLabelFrom+" "+P.length+"</span>"}W.pause=function(d,g){if(d&&g){W.pauseCallback=g;setTimeout(W.pause,d)}else{A(W.pauseCallback)}};function M(){A(document).keydown(function(g){var d;if(g.keyCode==39){d=a(1)}else{if(g.keyCode==37){d=a(-1)}else{if(g.keyCode==27){J()}}}if(d){N(A("#tinyLightboxContainer"),20,150)}})}this.slideShow=function(d){if(e.slideShow&&d=="getBtn"){if(Z){return A('<a id="slideShow" class="tinyLightboxBtn">Stop</a>').click(function(){W.slideShow("stop");A(this).html("Slideshow")})}else{return A('<a id="slideShow" class="tinyLightboxBtn">Slideshow</a>').click(function(){if(!Z){Z=window.setInterval(W.slideShow,e.slideShow)}A(this).html("Stop")})}}else{if(!d){if(a(1)){S=-1;a(1)}}else{if(d=="stop"){window.clearInterval(Z);Z=null}}}}}})(jQuery);